tests:
  - name: "Helper for bind"
    description: "如果没有--，以及后面跟着的用户传入的命令行，则输出bind子命令本身的帮助信息"
    cmd: "argonaut"
    args:
      - "bind"
      - "--shell-type=sh"
      - "--flag=level"
      - "--flag-level-helper=verbosity level"
      - "--help"
    expect:
      exitCode: 0
      stdout: |
        Bind collects declarative argument specifications (defaults, allowed values, required/multi flags),
        validates inputs, and supports two operation modes: auto, interactive and non-interactive.
        It can prompt users with keyboard-driven selectors, enforce allowed values,
        handle multi-valued flags, and finally emit shell-friendly "export" statements
        so calling scripts can eval/source the output to import variables into their environment.

        Usage:
          argonaut bind [flags] -- [user args include $0]

        Examples:
          [---in shell script: my-shell.sh---]
          argonaut bind \
            --flag flag-1 --flag-flag-1-default 1 --flag-flag-1-choices 1,2,3 \
            --flag flag-2 --flag-flag-2-required --flag-flag-2-choices a,b,c \
            -- $0 "$@"

          [---then use my-shell.sh like this:--]
          ./my-shell.sh --flag-1 2 --flag-2 b

        Flags:
          -r, --allow-repeated-flags             Allow repeated flag names
          -a, --args-range string                The range of positional arguments, e.g. 1, >1, <=3, [1,3], (,5], [2,), (,) for unlimited
          -d, --debug                            Enable debug mode, print output to stderr as well
          -e, --env-prefix string                The environment variable prefix for the command; all output env vars will be prefixed with it, except those whose names are specified using --flag-<name>-env-name
          -f, --flag strings                     Name For flag
              --flag-level-choices stringArray   Allowed choices for flag level
              --flag-level-default string        Default value for flag level. Note: default apply only when the flag is omitted; if the flag is present but given no value (e.g. '--level'), an empty value is used instead of the default.
              --flag-level-empty-value string    The value to use when flag level is present but given no explicit value (e.g. '--level'). Note: this applies only when the flag is provided without a value; it does not act as the default when the flag is omitted.
              --flag-level-env-name string       Environment variable name for flag level, default is upper-case with '-' replaced by '_', not effected by --env-prefix
              --flag-level-export                Whether flag level should be exported as environment variable
              --flag-level-helper string         Helper text for flag level
              --flag-level-multi                 Whether flag level is multi-valued
              --flag-level-multi-format string   Multi value format for flag level, allowed value are combined of comma, newline, space or json (default "comma")
              --flag-level-required              Whether flag level is required
              --flag-level-short string          Short name for flag level
          -h, --help                             help for bind
              --help-export                      Whether the help environment variable should be exported
              --help-var string                  The environment variable name to indicate help request, not effected by --env-prefix (default "IS_HELP")
          -l, --long string                      The long description of the command
          -n, --name string                      The name of the command
              --shell-type string                The shell type for output, allowed values: auto, sh, powershell, cmd (default "auto")
          -s, --short string                     The short description of the command
      stderr: ""
  - name: "Helper for user defined cmdline"
    description: "如果是有--，以及后面跟着的用户传入的命令行，则输出用户命令行的帮助信息"
    cmd: "argonaut"
    args:
      - "bind"
      - "--shell-type=sh"
      - "--flag=level"
      - "--flag-level-helper=verbosity level"
      - "--flag-level-choices=debug,info,warn,error"
      - "--flag-level-default=debug"
      - "--"
      - "a"
      - "--help"
    expect:
      exitCode: 0
      stdout: IS_HELP='true'
      stderr: |
        Usage:
          a [flags]

        Flags:
          -h, --help           help for a
              --level string   verbosity level (default "debug")
  - name: "Use custom help var name"
    description: "使用自定义的 help 环境变量名"
    cmd: "argonaut"
    args:
      - "bind"
      - "--shell-type=sh"
      - "--flag=level"
      - "--flag-level-helper=verbosity level"
      - "--flag-level-choices=debug,info,warn,error"
      - "--flag-level-default=debug"
      - "--help-var=CUSTOM_HELP_VAR"
      - "--"
      - "a"
      - "--help"
    expect:
      exitCode: 0
      stdout: CUSTOM_HELP_VAR='true'
      stderr: |
        Usage:
          a [flags]

        Flags:
          -h, --help           help for a
              --level string   verbosity level (default "debug")
  - name: "Use custom help var name and env prefix, env prefix should not affect help var"
    description: "使用自定义的 help 环境变量名和环境变量前缀, 环境变量前缀不应影响 help 变量名"
    cmd: "argonaut"
    args:
      - "bind"
      - "--shell-type=sh"
      - "--flag=level"
      - "--flag-level-helper=verbosity level"
      - "--flag-level-choices=debug,info,warn,error"
      - "--flag-level-default=debug"
      - "--help-var=CUSTOM_HELP_VAR"
      - "--env-prefix=PREFIX_"
      - "--"
      - "a"
      - "--help"
    expect:
      exitCode: 0
      stdout: CUSTOM_HELP_VAR='true'
      stderr: |
        Usage:
          a [flags]

        Flags:
          -h, --help           help for a
              --level string   verbosity level (default "debug")
  - name: "Export help env var"
    description: "使用自定义的 help 环境变量名"
    cmd: "argonaut"
    args:
      - "bind"
      - "--shell-type=sh"
      - "--flag=level"
      - "--flag-level-helper=verbosity level"
      - "--flag-level-choices=debug,info,warn,error"
      - "--flag-level-default=debug"
      - "--help-export"
      - "--"
      - "a"
      - "--help"
    expect:
      exitCode: 0
      stdout: export IS_HELP='true'
      stderr: |
        Usage:
          a [flags]

        Flags:
          -h, --help           help for a
              --level string   verbosity level (default "debug")
